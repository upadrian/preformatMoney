//URL: https://github.com/upadrian/preformatMoney/
(function(e,t,n,r){"use strict";function o(t,n){this.element=t;this.options=e.extend({},s,n);this.$el=e(t);this.init()}var i="preformat",s={symbol:"$",precision:2,thousand:",",decimal:".",format:"%s%v"};o.prototype={init:function(){if(this.preChecksFail(this))return false;var t='<input readonly="readonly" type="text" name="pre-'+this.$el.attr("name")+'" id="pre-'+this.$el.attr("id")+'" value="" />';this.$el.data("display",this.$el.css("display")).after(t).css("display","none");this.$target=e("#pre-"+this.$el.attr("id"));this.$target.css("display",this.$el.data("display")).css("cursor","pointer").attr("class",this.$el.attr("class"));this.getValue(this).setPreValue().setEvents()},preChecksFail:function(e){var e=e||this;if(!e.$el.attr("id")){try{console.log("Preformat plugin: missed id attribute on...");console.debug(e.$el)}catch(t){}return true}if(!e.$el.attr("name")){try{console.log("Preformat plugin: missed name attribute on...");console.debug(e.$el)}catch(t){}return true}if(e.$el.attr("type")!="text"&&e.$el.attr("type")!="number"){try{console.log("Preformat plugin: type "+e.$el.attr("type")+" not supported on...");console.debug(e.$el)}catch(t){}return true}if(typeof accounting!="object"){try{console.log("We need accounting plugin, get it on http://josscrowcroft.github.com/accounting.js")}catch(t){}return true}},getValue:function(e){var e=e||this;e.valorOriginal=e.$el.val();if(!e.isNumber(e.valorOriginal)){e.valorOriginal=0;e.$el.val(0)}return e},setEvents:function(t){var t=t||this;t.$target.focus(function(){e(this).css("display","none");t.$el.css("display",t.$el.data("display")).focus()});t.$el.blur(function(){e(this).css("display","none");t.$target.css("display",t.$el.data("display"))}).change(function(){if(isNaN(e(this).val())){e(this).val("0").change();return false}t.getValue().setPreValue()}).keypress(function(t){var n=t.which||t.keyCode,r=[8,9,13,16,17,27,35,36,37,38,39,40,46],i=String.fromCharCode(n);if(!i.match(/[0-9]/)&&e.inArray(n,r)<0&&i!="."&&i!="-")t.preventDefault()});return t},isNumber:function(e){return!isNaN(+e)&&isFinite(e)},setPreValue:function(e){var e=e||this;e.valor=accounting.formatMoney(e.valorOriginal,e.options.symbol,e.options.precision,e.options.thousand,e.options.decimal,e.options.format);e.$target.val(e.valor);return e},destroy:function(e){var e=e||this;e.$el.css("display",this.$el.data("display")).unbind("blur").unbind("change").unbind("keydown").data("plugin_"+i,false);e.$target.remove();e.$target=null}};e.fn[i]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+i))e.data(this,"plugin_"+i,new o(this,t));else{var n=e.data(this,"plugin_"+i);if(typeof n[t]==="function")return n[t]()}})}})(jQuery,document,window)